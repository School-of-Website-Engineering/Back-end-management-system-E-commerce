"use strict";(self["webpackChunkBack_end_management_system_E_commerce"]=self["webpackChunkBack_end_management_system_E_commerce"]||[]).push([[624],{5624:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),e("el-breadcrumb-item",[t._v("角色管理")]),e("el-breadcrumb-item",[t._v("角色列表")])],1),e("br"),e("el-card",[e("el-row",[e("el-button",{attrs:{type:"primary"}},[t._v("添加角色")])],1),e("br"),e("el-table",{attrs:{data:t.roleList,border:"",stripe:""}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},t._l(s.row.children,(function(a,r){return e("el-row",{key:a.id,class:["bdbottom",0===r?"bdtop":"","vcenter"]},[e("el-col",{attrs:{span:5}},[e("el-tag",{attrs:{closable:""},on:{close:function(e){return t.removeRightById(s.row,a.id)}}},[t._v(" "+t._s(a.authName))]),e("i",{staticClass:"el-icon-arrow-right"})],1),e("el-col",{attrs:{span:19}},t._l(a.children,(function(a,r){return e("el-row",{key:a.id,class:[0===r?"":"bdtop","vcenter"]},[e("el-col",{attrs:{span:6}},[e("el-tag",{attrs:{closable:"",type:"success"},on:{close:function(e){return t.removeRightById(s.row,a.id)}}},[t._v(" "+t._s(a.authName))]),e("i",{staticClass:"el-icon-arrow-right"})],1),e("el-col",{attrs:{span:18}},t._l(a.children,(function(a){return e("el-tag",{key:a.id,attrs:{type:"warning",closable:""},on:{close:function(e){return t.removeRightById(s.row,a.id)}}},[t._v(" "+t._s(a.authName)+" ")])})),1)],1)})),1)],1)})),1)]}}])}),e("el-table-column",{attrs:{prop:"id",label:"ID",width:"100"}}),e("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),e("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),e("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"text",size:"small"}},[t._v("分配权限")]),e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.showEditDialog(s.row.id+"")}}},[t._v("编辑")]),e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.removeUserById(s.row.id)}}},[t._v("删除")])]}}])})],1)],1),e("el-dialog",{attrs:{title:"修改角色",visible:t.editDialogVisible,width:"50%"},on:{"update:visible":function(e){t.editDialogVisible=e}}},[e("el-form",{ref:"editForm",attrs:{model:t.roleList,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"角色名称"}},[e("el-input",{model:{value:t.roleList.roleName,callback:function(e){t.$set(t.roleList,"roleName",e)},expression:"roleList.roleName"}})],1),e("el-form-item",{attrs:{label:"角色描述"}},[e("el-input",{model:{value:t.roleList.roleDesc,callback:function(e){t.$set(t.roleList,"roleDesc",e)},expression:"roleList.roleDesc"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.editDialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.editRole}},[t._v("确 定")])],1)],1)],1)},r=[],l={data(){return{roleList:[],editDialogVisible:!1}},created(){this.getRoleList()},methods:{async getRoleList(){const{data:t}=await this.$http.get("roles");if(200!==t.meta.status)return this.$message.error("获取角色列表失败");this.roleList=t.data},async removeUserById(t){const e=await this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});if("cancel"===e)return this.$message.info("已取消删除");const{data:s}=await this.$http.delete(`roles/${t}`);if(200!==s.meta.status)return this.$message.error("删除角色失败");this.$message.success("删除角色成功"),await this.getRoleList()},async showEditDialog(t){const{data:e}=await this.$http.get(`roles/${t}`);if(200!==e.meta.status)return this.$message.error("获取角色信息失败");this.roleList=e.data,this.editDialogVisible=!0},async editRole(){const{roleName:t,roleDesc:e}=this.roleList,{data:s}=await this.$http.put(`roles/${this.roleList.id}`,{roleName:t,roleDesc:e});if(200!==s.meta.status)return this.$message.error(s.meta.msg);this.$message.success("修改角色信息成功"),this.editDialogVisible=!1,await this.getRoleList()},async removeRightById(t,e){const s=await this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((t=>t));if("confirm"!==s)return this.$message.info("已取消删除");const{data:a}=await this.$http.delete(`roles/${t.id}/rights/${e}`);if(200!==a.meta.status)return this.$message.error("删除权限失败");this.$message.success("删除权限成功"),t.children=a.data}}},i=l,o=s(1001),n=(0,o.Z)(i,a,r,!1,null,"73f88fd1",null),c=n.exports}}]);
//# sourceMappingURL=624.250c0480.js.map